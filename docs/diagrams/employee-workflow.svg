<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="916px" preserveAspectRatio="none" style="width:959px;height:916px;" version="1.1" viewBox="0 0 959 916" width="959px" zoomAndPan="magnify"><defs><filter height="300%" id="f12f62g0fbgd0k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><rect width="100%" height="100%" fill="#FFFFFF"/><g><rect fill="#FFFFFF" filter="url(#f12f62g0fbgd0k)" height="516.8672" style="stroke: #000000; stroke-width: 2.0;" width="935" x="13" y="161.5625"/><rect fill="#FFFFFF" filter="url(#f12f62g0fbgd0k)" height="427.4688" style="stroke: #000000; stroke-width: 2.0;" width="915" x="23" y="243.9609"/><rect fill="#FFFFFF" filter="url(#f12f62g0fbgd0k)" height="206.7344" style="stroke: #000000; stroke-width: 2.0;" width="895" x="33" y="355.4922"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="895" x="33" y="489.1563"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="915" x="23" y="627.4922"/><rect fill="#FFFFFF" filter="url(#f12f62g0fbgd0k)" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="709" x="33" y="692.4297"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="709" x="33" y="738.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="80" x2="80" y1="86.2969" y2="828.7656"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="647" x2="647" y1="86.2969" y2="828.7656"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="870" x2="870" y1="86.2969" y2="828.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="43" y="82.9951">Employee</text><ellipse cx="80" cy="13" fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M80,21 L80,48 M67,29 L93,29 M80,48 L67,63 M80,48 L93,63 " fill="none" filter="url(#f12f62g0fbgd0k)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="43" y="840.7607">Employee</text><ellipse cx="80" cy="854.0625" fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M80,862.0625 L80,889.0625 M67,870.0625 L93,870.0625 M80,889.0625 L67,904.0625 M80,889.0625 L93,904.0625 " fill="none" filter="url(#f12f62g0fbgd0k)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="562" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="569" y="70.9951">ServicePointController</text><rect fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="562" y="827.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="569" y="847.7607">ServicePointController</text><rect fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="822" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="829" y="70.9951">VisitService</text><rect fill="#FEFECE" filter="url(#f12f62g0fbgd0k)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="822" y="827.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="829" y="847.7607">VisitService</text><polygon fill="#A80036" points="635,113.4297,645,117.4297,635,121.4297,639,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="87" y="112.3638">POST /servicepoint/.../open</text><polygon fill="#A80036" points="858,142.5625,868,146.5625,858,150.5625,862,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="654" y="141.4966">openServicePoint(...)</text><path d="M13,161.5625 L90,161.5625 L90,168.5625 L80,178.5625 L13,178.5625 L13,161.5625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="516.8672" style="stroke: #000000; stroke-width: 2.0;" width="935" x="13" y="161.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="174.6294">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="105" y="173.7729">[Работа с визитами]</text><polygon fill="#A80036" points="635,195.8281,645,199.8281,635,203.8281,639,199.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="199.8281" y2="199.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="264" x="87" y="194.7622">POST /servicepoint/.../confirmed/visits/call</text><polygon fill="#A80036" points="858,224.9609,868,228.9609,858,232.9609,862,228.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="228.9609" y2="228.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="654" y="223.895">callNextVisit(...)</text><path d="M23,243.9609 L87,243.9609 L87,250.9609 L77,260.9609 L23,260.9609 L23,243.9609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="427.4688" style="stroke: #000000; stroke-width: 2.0;" width="915" x="23" y="243.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="257.0278">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="102" y="256.1714">[визит найден]</text><polygon fill="#A80036" points="91,278.2266,81,282.2266,91,286.2266,87,282.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="85" x2="646" y1="282.2266" y2="282.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="97" y="277.1606">Visit</text><polygon fill="#A80036" points="635,307.3594,645,311.3594,635,315.3594,639,311.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="311.3594" y2="311.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="543" x="87" y="306.2935">POST /servicepoint/.../visits/servicePoints/{servicePointId}/confirmed/confirm/{visitId}</text><polygon fill="#A80036" points="858,336.4922,868,340.4922,858,344.4922,862,340.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="340.4922" y2="340.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="654" y="335.4263">visitConfirm(...)</text><path d="M33,355.4922 L97,355.4922 L97,362.4922 L87,372.4922 L33,372.4922 L33,355.4922 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="206.7344" style="stroke: #000000; stroke-width: 2.0;" width="895" x="33" y="355.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="48" y="368.5591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="112" y="367.7026">[требуется перевод]</text><polygon fill="#A80036" points="635,389.7578,645,393.7578,635,397.7578,639,393.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="393.7578" y2="393.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="436" x="87" y="388.6919">PUT /servicepoint/.../queue/{queueId}/visit/transferFromServicePoint</text><polygon fill="#A80036" points="858,418.8906,868,422.8906,858,426.8906,862,422.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="422.8906" y2="422.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="654" y="417.8247">visitTransfer(...)</text><polygon fill="#A80036" points="635,448.0234,645,452.0234,635,456.0234,639,452.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="452.0234" y2="452.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="402" x="87" y="446.9575">PUT /servicepoint/.../poolServicePoint/{poolSpId}/visit/put_back</text><polygon fill="#A80036" points="858,477.1563,868,481.1563,858,485.1563,862,481.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="481.1563" y2="481.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="654" y="476.0903">visitBackToServicePointPool(...)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="928" y1="490.1563" y2="490.1563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="38" y="500.3667">[повторный вызов]</text><polygon fill="#A80036" points="635,521.0938,645,525.0938,635,529.0938,639,525.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="525.0938" y2="525.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="529" x="87" y="520.0278">POST /servicepoint/.../visits/servicePoints/{servicePointId}/confirmed/recall/{visitId}</text><polygon fill="#A80036" points="858,550.2266,868,554.2266,858,558.2266,862,554.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="554.2266" y2="554.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="654" y="549.1606">visitReCallForConfirm(...)</text><polygon fill="#A80036" points="635,586.3594,645,590.3594,635,594.3594,639,590.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="590.3594" y2="590.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="415" x="87" y="585.2935">PUT /servicepoint/.../visits/servicePoints/{servicePointId}/visit/end</text><polygon fill="#A80036" points="858,615.4922,868,619.4922,858,623.4922,862,619.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="619.4922" y2="619.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="654" y="614.4263">visitEnd(...)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="938" y1="628.4922" y2="628.4922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="28" y="638.7026">[очередь пуста]</text><polygon fill="#A80036" points="91,659.4297,81,663.4297,91,667.4297,87,663.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="85" x2="646" y1="663.4297" y2="663.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="97" y="658.3638">204 No Content</text><path d="M33,692.4297 L97,692.4297 L97,699.4297 L87,709.4297 L33,709.4297 L33,692.4297 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="709" x="33" y="692.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="48" y="705.4966">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="112" y="704.6401">[Перерыв]</text><polygon fill="#A80036" points="635,726.6953,645,730.6953,635,734.6953,639,730.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="730.6953" y2="730.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="87" y="725.6294">POST /servicepoint/.../servicePoints/{servicePointId}/close?isBreak=true</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="742" y1="739.6953" y2="739.6953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="38" y="749.9058">[Выход]</text><polygon fill="#A80036" points="635,770.6328,645,774.6328,635,778.6328,639,774.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="641" y1="774.6328" y2="774.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="375" x="87" y="769.5669">POST /servicepoint/.../servicePoints/{servicePointId}/logout</text><polygon fill="#A80036" points="858,806.7656,868,810.7656,858,814.7656,862,810.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="647" x2="864" y1="810.7656" y2="810.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="654" y="805.6997">closeServicePoint(...)</text><!--MD5=[d261a83ab46cb2510180612c8a0af6a7]
@startuml
skinparam backgroundColor #FFFFFF
actor Employee
participant API as "ServicePointController"
participant Visit as "VisitService"

Employee -> API: POST /servicepoint/.../open
API -> Visit: openServicePoint(...)

loop Работа с визитами
  Employee -> API: POST /servicepoint/.../confirmed/visits/call
  API -> Visit: callNextVisit(...)
  alt визит найден
    API - -> Employee: Visit
    Employee -> API: POST /servicepoint/.../visits/servicePoints/{servicePointId}/confirmed/confirm/{visitId}
    API -> Visit: visitConfirm(...)
    alt требуется перевод
      Employee -> API: PUT /servicepoint/.../queue/{queueId}/visit/transferFromServicePoint
      API -> Visit: visitTransfer(...)
      Employee -> API: PUT /servicepoint/.../poolServicePoint/{poolSpId}/visit/put_back
      API -> Visit: visitBackToServicePointPool(...)
    else повторный вызов
      Employee -> API: POST /servicepoint/.../visits/servicePoints/{servicePointId}/confirmed/recall/{visitId}
      API -> Visit: visitReCallForConfirm(...)
    end
    Employee -> API: PUT /servicepoint/.../visits/servicePoints/{servicePointId}/visit/end
    API -> Visit: visitEnd(...)
  else очередь пуста
    API - -> Employee: 204 No Content
  end
end

alt Перерыв
  Employee -> API: POST /servicepoint/.../servicePoints/{servicePointId}/close?isBreak=true
else Выход
  Employee -> API: POST /servicepoint/.../servicePoints/{servicePointId}/logout
end
API -> Visit: closeServicePoint(...)
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.2+13-58
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>