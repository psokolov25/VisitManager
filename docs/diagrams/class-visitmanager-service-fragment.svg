<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="298px" preserveAspectRatio="none" style="width:1298px;height:298px;" version="1.1" viewBox="0 0 1298 298" width="1298px" zoomAndPan="magnify"><defs><filter height="300%" id="f1nbv05sd34kwo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><rect width="100%" height="100%" fill="#FFFFFF"/><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="549" x="378.5" y="16.708">VisitService: зависимости и правила управления визитом</text><!--MD5=[a928950a7807a79b8234feadd5d78369]
class VisitService--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="142.4063" id="VisitService" style="stroke: #A80036; stroke-width: 1.5;" width="407" x="409" y="28.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="577" y="45.0918">VisitService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="410" x2="815" y1="52.9219" y2="52.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="166" x="415" y="67.1323">-CallRule waitingTimeCallRule</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="143" x="415" y="79.937">-CallRule lifeTimeCallRule</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="415" y="92.7417">-SegmentationRule segmentationRule</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="410" x2="815" y1="99.3359" y2="99.3359"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="177" x="415" y="113.5464">+Visit getVisit(branchId, visitId)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="415" y="126.3511">+List&lt;Visit&gt; getVisits(branchId, queueId)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="395" x="415" y="139.1558">+Visit createVisit(branchId, entryPointId, VisitParameters, printTicket)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="415" y="151.9604">+Visit visitPostPone(branchId, visitId)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="193" x="415" y="164.7651">+void deleteVisit(branchId, visitId)</text><!--MD5=[6ad6945def856d0748cfc6785c16a6a7]
class BranchService--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="BranchService" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="6" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="89" x="9" y="264.0918">BranchService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="100" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="100" y1="279.9219" y2="279.9219"/><!--MD5=[8736b572be702d5ae6361a5a5cce2687]
class EventService--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="EventService" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="202.5" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="80" x="205.5" y="264.0918">EventService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="203.5" x2="287.5" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="203.5" x2="287.5" y1="279.9219" y2="279.9219"/><!--MD5=[af68eece8ad687dae42ca2e9a5f9b6a5]
class DelayedEvents--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="DelayedEvents" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="380.5" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="92" x="383.5" y="264.0918">DelayedEvents</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="381.5" x2="477.5" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="381.5" x2="477.5" y1="279.9219" y2="279.9219"/><!--MD5=[a6c411ece6777481b4f534d8d2f1b805]
class PrinterService--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="PrinterService" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="566" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="569" y="264.0918">PrinterService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="567" x2="658" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="567" x2="658" y1="279.9219" y2="279.9219"/><!--MD5=[8c55c79778dd70b9440459d26f3f5f5a]
class KeyCloackClient--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="KeyCloackClient" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="713" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="716" y="264.0918">KeyCloackClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="714" x2="815" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="714" x2="815" y1="279.9219" y2="279.9219"/><!--MD5=[64ea2f2265774a3820a42137cd330fcd]
class CallRule--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="CallRule" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="963" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="966" y="264.0918">CallRule</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="964" x2="1017" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="964" x2="1017" y1="279.9219" y2="279.9219"/><!--MD5=[10f4b58fdc66df72f029f4b636d1b57f]
class SegmentationRule--><rect fill="#FEFECE" filter="url(#f1nbv05sd34kwo)" height="39.9688" id="SegmentationRule" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="1122" y="247.9531"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="1125" y="264.0918">SegmentationRule</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1123" x2="1242" y1="271.9219" y2="271.9219"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1123" x2="1242" y1="279.9219" y2="279.9219"/><!--MD5=[74bf68b22fb1621006db700a076feeed]
link VisitService to BranchService--><path d="M408.83,114.8831 C315.9,127.9231 207.08,152.9731 118.5,200.9531 C99.37,211.3131 82.31,229.1531 70.47,243.6731 " fill="none" id="VisitService-&gt;BranchService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="67.27,247.6731,76.0117,243.1363,70.39,243.766,69.7603,238.1443,67.27,247.6731" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="119.5" y="214.02">состояние отделений</text><!--MD5=[cf99a0e6e886722ef32685d5c7192562]
link VisitService to EventService--><path d="M408.83,145.3431 C369.49,159.3231 330.11,177.4731 296.5,200.9531 C280.68,212.0031 267.52,229.4231 258.53,243.5931 " fill="none" id="VisitService-&gt;EventService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="255.87,247.8731,264.0236,242.3488,258.5136,243.6291,257.2332,238.1191,255.87,247.8731" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="297.5" y="214.02">публикация событий</text><!--MD5=[c758cf680a2fdfefd23acf09b0e92ee9]
link VisitService to DelayedEvents--><path d="M489.27,171.1131 C478.09,180.2931 467.58,190.2631 458.5,200.9531 C448.18,213.1031 440.95,229.4931 436.29,242.9031 " fill="none" id="VisitService-&gt;DelayedEvents" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="434.69,247.7031,441.3374,240.4359,436.2754,242.9611,433.7502,237.8992,434.69,247.7031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="459.5" y="214.02">планирование задач</text><!--MD5=[ab866ab3ea45a300cd2381d13e721b0f]
link VisitService to PrinterService--><path d="M609.42,171.1731 C609.1,186.5931 609.04,202.8231 609.5,217.9531 C609.75,225.9831 610.22,234.7431 610.71,242.6031 " fill="none" id="VisitService-&gt;PrinterService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="611.06,247.8831,614.4595,238.6396,610.7312,242.8939,606.4768,239.1656,611.06,247.8831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="610.5" y="214.02">печать талонов</text><!--MD5=[834af8e79e14dfd230a9d66a13bb25c3]
link VisitService to KeyCloackClient--><path d="M697.76,171.0931 C707.58,180.6831 717.08,190.7531 725.5,200.9531 C736.14,213.8431 745.73,229.9731 752.73,243.0531 " fill="none" id="VisitService-&gt;KeyCloackClient" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="755.19,247.7231,754.5419,237.8956,752.863,243.2976,747.461,241.6188,755.19,247.7231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="739.5" y="214.02">сведения о пользователях</text><!--MD5=[64c22553cca467f3ed6609ad4fc3edbe]
link VisitService to CallRule--><path d="M816.34,146.2731 C856.68,160.2131 897.36,178.1131 932.5,200.9531 C949.54,212.0231 964.55,229.4531 975.03,243.6131 " fill="none" id="VisitService-&gt;CallRule" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="978.13,247.8931,976.0835,238.2592,975.1942,243.8458,969.6077,242.9565,978.13,247.8931" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="954.5" y="214.02">правила автодозвона</text><!--MD5=[442118e67b881bb58e001038f986c91a]
link VisitService to SegmentationRule--><path d="M816.25,115.3331 C910.82,128.4431 1022.25,153.4331 1113.5,200.9531 C1133.39,211.3131 1151.53,229.1531 1164.21,243.6731 " fill="none" id="VisitService-&gt;SegmentationRule" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1167.64,247.6731,1164.8023,238.2419,1164.379,243.8829,1158.738,243.4595,1167.64,247.6731" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="1137.5" y="214.02">сегментация визитов</text><!--MD5=[ee2af8e51483e1acdfdc80b9938d4a47]
@startuml
skinparam backgroundColor #FFFFFF
title VisitService: зависимости и правила управления визитом

skinparam classAttributeIconSize 0
hide circle

class VisitService {
  +Visit getVisit(branchId, visitId)
  +List<Visit> getVisits(branchId, queueId)
  +Visit createVisit(branchId, entryPointId, VisitParameters, printTicket)
  +Visit visitPostPone(branchId, visitId)
  +void deleteVisit(branchId, visitId)
  -CallRule waitingTimeCallRule
  -CallRule lifeTimeCallRule
  -SegmentationRule segmentationRule
}

class BranchService
class EventService
class DelayedEvents
class PrinterService
class KeyCloackClient
class CallRule
class SegmentationRule

VisitService - -> BranchService : состояние отделений
VisitService - -> EventService : публикация событий
VisitService - -> DelayedEvents : планирование задач
VisitService - -> PrinterService : печать талонов
VisitService - -> KeyCloackClient : сведения о пользователях
VisitService - -> CallRule : правила автодозвона
VisitService - -> SegmentationRule : сегментация визитов

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.2+13-58
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>